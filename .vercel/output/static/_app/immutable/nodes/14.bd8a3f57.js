import{I as j,s as ee,f as E,a as I,g as N,h as K,r as L,c as T,d as k,j as A,i as D,x as S,F as O,y as U,z as se,o as le,e as G,J as ie,u as ce}from"../chunks/scheduler.c4785dc3.js";import{S as te,i as ae,b as w,d as y,m as C,a as d,g as V,t as $,c as q,e as P}from"../chunks/index.42f95a44.js";import{b as ue,V as fe,R as pe,r as me,f as _e,C as de,M as $e,e as J,L as ge,a as he,P as be}from"../chunks/Modal.6c76a5fc.js";import{w as B}from"../chunks/index.09294a58.js";import{d as ve}from"../chunks/popularpeople.9f2cf5e3.js";import{p as Q}from"../chunks/prioritizeimages.97612009.js";const W=B([]),z=B(1),re=B(1),ne=B([]),oe=B([]),H=async(i,e=!1)=>{const n=e?j(z)+1:1,t={method:"GET",url:`https://api.themoviedb.org/3/search/multi?query=${encodeURIComponent(i)}&language=en-US&page=${n}`,headers:{accept:"application/json",Authorization:`Bearer ${fe}`}};try{const a=await ue.request(t);let o=a.data.results;const r=await Promise.all(o.map(async _=>{if(_.media_type==="person"){const b=await ve(_.id);return{..._,actorDetail:b}}return _}));o=e?[...j(W),...r]:r,W.set(o),z.set(a.data.page),re.set(a.data.total_pages);const u=o.filter(_=>_.media_type==="movie"),s=o.filter(_=>_.media_type==="person");ne.set(u),oe.set(s)}catch(a){console.error(a)}};function X(i,e,n){const t=i.slice();return t[12]=e[n],t}function Y(i){let e,n,t,a;return e=new de({props:{$$slots:{default:[ke]},$$scope:{ctx:i}}}),t=new $e({props:{selectedItem:i[4],close:i[9]}}),{c(){w(e.$$.fragment),n=I(),w(t.$$.fragment)},l(o){y(e.$$.fragment,o),n=T(o),y(t.$$.fragment,o)},m(o,r){C(e,o,r),D(o,n,r),C(t,o,r),a=!0},p(o,r){const u={};r&32769&&(u.$$scope={dirty:r,ctx:o}),e.$set(u);const s={};r&16&&(s.selectedItem=o[4]),t.$set(s)},i(o){a||(d(e.$$.fragment,o),d(t.$$.fragment,o),a=!0)},o(o){$(e.$$.fragment,o),$(t.$$.fragment,o),a=!1},d(o){o&&k(n),P(e,o),P(t,o)}}}function Z(i){let e,n;function t(){return i[11](i[12])}return e=new he({props:{item:i[12]}}),e.$on("itemClick",t),{c(){w(e.$$.fragment)},l(a){y(e.$$.fragment,a)},m(a,o){C(e,a,o),n=!0},p(a,o){i=a;const r={};o&1&&(r.item=i[12]),e.$set(r)},i(a){n||(d(e.$$.fragment,a),n=!0)},o(a){$(e.$$.fragment,a),n=!1},d(a){P(e,a)}}}function ke(i){let e,n,t=J(i[0].sort(Q)),a=[];for(let r=0;r<t.length;r+=1)a[r]=Z(X(i,t,r));const o=r=>$(a[r],1,1,()=>{a[r]=null});return{c(){for(let r=0;r<a.length;r+=1)a[r].c();e=G()},l(r){for(let u=0;u<a.length;u+=1)a[u].l(r);e=G()},m(r,u){for(let s=0;s<a.length;s+=1)a[s]&&a[s].m(r,u);D(r,e,u),n=!0},p(r,u){if(u&257){t=J(r[0].sort(Q));let s;for(s=0;s<t.length;s+=1){const _=X(r,t,s);a[s]?(a[s].p(_,u),d(a[s],1)):(a[s]=Z(_),a[s].c(),d(a[s],1),a[s].m(e.parentNode,e))}for(V(),s=t.length;s<a.length;s+=1)o(s);q()}},i(r){if(!n){for(let u=0;u<t.length;u+=1)d(a[u]);n=!0}},o(r){a=a.filter(Boolean);for(let u=0;u<a.length;u+=1)$(a[u]);n=!1},d(r){r&&k(e),ie(a,r)}}}function x(i){let e,n;return e=new ge({props:{onClick:i[7]}}),{c(){w(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,a){C(e,t,a),n=!0},p:ce,i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function we(i){let e,n,t="Search All",a,o,r,u,s,_="go",b,g,v,h,R,m,M,l=i[0].length>0&&Y(i),f=i[2]<=i[3]&&x(i);return h=new pe({}),{c(){e=E("div"),n=E("p"),n.textContent=t,a=I(),o=E("div"),r=E("input"),u=I(),s=E("button"),s.textContent=_,b=I(),l&&l.c(),g=I(),f&&f.c(),v=I(),w(h.$$.fragment),this.h()},l(c){e=N(c,"DIV",{class:!0});var p=K(e);n=N(p,"P",{"data-svelte-h":!0}),L(n)!=="svelte-11pbtr1"&&(n.textContent=t),a=T(p),o=N(p,"DIV",{class:!0});var F=K(o);r=N(F,"INPUT",{type:!0,placeholder:!0}),u=T(F),s=N(F,"BUTTON",{class:!0,"data-svelte-h":!0}),L(s)!=="svelte-1mltr76"&&(s.textContent=_),F.forEach(k),p.forEach(k),b=T(c),l&&l.l(c),g=T(c),f&&f.l(c),v=T(c),y(h.$$.fragment,c),this.h()},h(){A(r,"type","text"),A(r,"placeholder","Search entire datab..."),A(s,"class","button-styles"),A(o,"class","input-and-button"),A(e,"class","page-header-container")},m(c,p){D(c,e,p),S(e,n),S(e,a),S(e,o),S(o,r),O(r,i[1]),S(o,u),S(o,s),D(c,b,p),l&&l.m(c,p),D(c,g,p),f&&f.m(c,p),D(c,v,p),C(h,c,p),R=!0,m||(M=[U(r,"input",i[10]),U(r,"keydown",i[6]),U(s,"click",i[5])],m=!0)},p(c,[p]){p&2&&r.value!==c[1]&&O(r,c[1]),c[0].length>0?l?(l.p(c,p),p&1&&d(l,1)):(l=Y(c),l.c(),d(l,1),l.m(g.parentNode,g)):l&&(V(),$(l,1,1,()=>{l=null}),q()),c[2]<=c[3]?f?(f.p(c,p),p&12&&d(f,1)):(f=x(c),f.c(),d(f,1),f.m(v.parentNode,v)):f&&(V(),$(f,1,1,()=>{f=null}),q())},i(c){R||(d(l),d(f),d(h.$$.fragment,c),R=!0)},o(c){$(l),$(f),$(h.$$.fragment,c),R=!1},d(c){c&&(k(e),k(b),k(g),k(v)),l&&l.d(c),f&&f.d(c),P(h,c),m=!1,se(M)}}}function ye(i,e,n){let t=[],a="Tolkien",o=1,r=1,u=null;ne.subscribe(m=>{const M=m.map(l=>({id:l.id,title:l.title,rating:l.vote_average,popularity:me(l.popularity),backdrop_path:l.poster_path,overview:l.overview,release_date:_e(l.release_date),datatype:"movie"}));n(0,t=[...M,...t])}),oe.subscribe(m=>{const M=m.map(l=>({id:l.id,datatype:"person",title:l.name,popularity:l.popularity,actorDetail:l.actorDetail,knownFor:l.known_for.map(f=>({id:f.id,title:f.title,poster_path:f.backdrop_path,rating:f.vote_average,release_date:f.release_date})),gender:l.gender===1?"Female":"Male",known_for_department:l.known_for_department,backdrop_path:l.profile_path}));n(0,t=[...M,...t])}),console.log(t),z.subscribe(m=>n(2,o=m)),re.subscribe(m=>n(3,r=m));const s=()=>{n(0,t=[]),H(a)},_=m=>{m.key==="Enter"&&s()},b=()=>{H(a,!0)},g=m=>{n(4,u=m)},v=()=>{n(4,u=null)};le(()=>{s()});function h(){a=this.value,n(1,a)}return[t,a,o,r,u,s,_,b,g,v,h,m=>g(m)]}class Ce extends te{constructor(e){super(),ae(this,e,ye,we,ee,{})}}function Pe(i){let e,n;return e=new Ce({}),{c(){w(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,a){C(e,t,a),n=!0},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}function Me(i){let e,n;return e=new be({props:{$$slots:{default:[Pe]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},l(t){y(e.$$.fragment,t)},m(t,a){C(e,t,a),n=!0},p(t,[a]){const o={};a&1&&(o.$$scope={dirty:a,ctx:t}),e.$set(o)},i(t){n||(d(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){P(e,t)}}}class Ne extends te{constructor(e){super(),ae(this,e,null,Me,ee,{})}}export{Ne as component};
